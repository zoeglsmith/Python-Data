<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat May 27 09:47:58 UTC 2023

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5689] NPE at ThreadLocalProviders.getContextResolver()</title>
                <link>https://issues.apache.org/jira/browse/CXF-5689</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I have extensions of the following classes in my application used as providers when creating jaxrs clients or servers.&lt;/p&gt;

&lt;p&gt;javax.ws.rs.ext.ContextResolver&lt;br/&gt;
javax.ws.rs.ext.MessageBodyReader&lt;br/&gt;
javax.ws.rs.ext.MessageBodyWriter&lt;br/&gt;
javax.ws.rs.ext.ExceptionMapper&lt;br/&gt;
org.apache.cxf.jaxrs.client.ResponseExceptionMapper&lt;/p&gt;

&lt;p&gt;All my custom providers have the following member field injected at runtime.&lt;br/&gt;
@Context private Providers providers;&lt;/p&gt;

&lt;p&gt;Within the providers&apos; methods I&apos;m calling this:&lt;br/&gt;
providers.getContextResolver(aClass, aMediaType);&lt;/p&gt;

&lt;p&gt;This is causing a NullPointerException for the ResponseExceptionMapper. All the other providers have no problem getting the context resolver.&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
        at org.apache.cxf.jaxrs.impl.tl.ThreadLocalProviders.getContextResolver(ThreadLocalProviders.java:50)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12708540">CXF-5689</key>
            <summary>NPE at ThreadLocalProviders.getContextResolver()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="hoomanv">Hooman Valibeigi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Apr 2014 15:53:49 +0000</created>
                <updated>Mon, 12 Oct 2015 20:36:18 +0000</updated>
                            <resolved>Wed, 16 Apr 2014 16:12:46 +0000</resolved>
                                    <version>2.7.11</version>
                                    <fixVersion>3.0</fixVersion>
                    <fixVersion>2.7.12</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13969661" author="sergey_beryozkin" created="Tue, 15 Apr 2014 16:03:15 +0000"  >&lt;p&gt;Do you mean that you have a custom ResponseExceptionMapper implementation and you have Providers injected into it and call&lt;/p&gt;

&lt;p&gt;providers.getContextResolver(aClazz, aMediaType); &lt;/p&gt;

&lt;p&gt;from its fromResponse method ?&lt;/p&gt;</comment>
                            <comment id="13969674" author="hoomanv" created="Tue, 15 Apr 2014 16:14:02 +0000"  >&lt;p&gt;That&apos;s right Sergey Beryozkin&lt;/p&gt;</comment>
                            <comment id="14952274" author="fadi.mohsen@gmail.com" created="Sun, 11 Oct 2015 12:23:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; I see this NPE exception and cant figure out why it happens, I do not have custom mappers.&lt;/p&gt;

&lt;p&gt;I run on Java8, CXF 3.1.0 and jackson 2.6.1, below is how I wire up:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;JAXRSServerFactoryBean sf = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JAXRSServerFactoryBean();
sf.setProviders(Arrays.asList(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] { &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JacksonJsonProvider() }));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;any hints?&lt;/p&gt;

&lt;p&gt;thanks in advance&lt;/p&gt;</comment>
                            <comment id="14952321" author="sergey_beryozkin" created="Sun, 11 Oct 2015 16:03:41 +0000"  >&lt;p&gt;this is related to a side-effect caused by the introduction of WeakHashMap into keeping thread local proxies which seems to be only affecting the client side. CXF 3.1.3 has a workaround and in 3.1.4 the use of WeakHashMap has been reverted &lt;/p&gt;</comment>
                            <comment id="14952345" author="fadi.mohsen@gmail.com" created="Sun, 11 Oct 2015 17:15:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; for me, this happens in server/service, and happens sporadically (painful) :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; java.lang.NullPointerException
  at org.apache.cxf.jaxrs.impl.tl.ThreadLocalProviders.getContextResolver(ThreadLocalProviders.java:50)
  at com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider._locateMapperViaProvider(JacksonJsonProvider.java:198)
  at com.fasterxml.jackson.jaxrs.base.ProviderBase.locateMapper(ProviderBase.java:864)
  at com.fasterxml.jackson.jaxrs.base.ProviderBase.readFrom(ProviderBase.java:758)
  at org.apache.cxf.jaxrs.utils.JAXRSUtils.readFromMessageBodyReader(JAXRSUtils.java:1337)
  at org.apache.cxf.jaxrs.utils.JAXRSUtils.readFromMessageBody(JAXRSUtils.java:1288)
  at org.apache.cxf.jaxrs.utils.JAXRSUtils.processParameter(JAXRSUtils.java:824)
  at org.apache.cxf.jaxrs.utils.JAXRSUtils.processParameters(JAXRSUtils.java:787)
  at org.apache.cxf.jaxrs.interceptor.JAXRSInInterceptor.processRequest(JAXRSInInterceptor.java:212)
  at org.apache.cxf.jaxrs.interceptor.JAXRSInInterceptor.handleMessage(JAXRSInInterceptor.java:77)
  at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307)
  at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)
  at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:251)
  at org.apache.cxf.transport.http_jetty.JettyHTTPDestination.doService(JettyHTTPDestination.java:234)
  at org.apache.cxf.transport.http_jetty.JettyHTTPHandler.handle(JettyHTTPHandler.java:70)
  at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1129)
  at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1065)
  at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
  at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)
  at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
  at org.eclipse.jetty.server.Server.handle(Server.java:497)
  at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)
  at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)
  at org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)
  at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)
  at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)
  at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="14952824" author="sergey_beryozkin" created="Mon, 12 Oct 2015 08:55:18 +0000"  >&lt;p&gt;Are you reusing a single Jackson instance between multiple endpoints but with each of them having a unique bus ? That should be covered...If not then as I said 3.1.3 should fix it, and 3.1.4 will def fix it &lt;/p&gt;</comment>
                            <comment id="14953691" author="fadi.mohsen@gmail.com" created="Mon, 12 Oct 2015 20:36:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; thank you for explaining&lt;br/&gt;
Ill try out below and dig more examples on CXF + Jackson.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;JAXRSServerFactoryBean sf = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JAXRSServerFactoryBean();
        sf.setProviders(Arrays.asList(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JacksonJaxbJsonProvider(){
        	&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; ObjectMapper _locateMapperViaProvider(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; type, MediaType mediaType) {
        		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ObjectMapper();
        	}
        }));

        Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;, ?&amp;gt; resources = getResources();
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;, ?&amp;gt; entry : resources.entrySet()) {
            sf.setResourceClasses(entry.getKey());
            sf.setResourceProvider(entry.getKey(), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SingletonResourceProvider(entry.getValue()));
        }
....
       sf.create()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>386863</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1un7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>387127</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>