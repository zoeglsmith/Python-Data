<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat May 27 09:45:44 UTC 2023

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4127] CXFServlet should be reinitialized on ContextRefreshedEvent</title>
                <link>https://issues.apache.org/jira/browse/CXF-4127</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I have a web application that uses Spring and CXF and is deployed on Tomcat. The application is initialized using the &lt;tt&gt;org.springframework.web.context.ContextLoaderListener&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;With the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-4094&quot; title=&quot;Refreshing Spring application context leads to NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-4094&quot;&gt;&lt;del&gt;CXF-4094&lt;/del&gt;&lt;/a&gt; I am now able to refresh the Spring context (like described below) without any exceptions but since the &lt;tt&gt;CXFServlet&lt;/tt&gt; isn&apos;t created by Spring and doesn&apos;t listen for &lt;tt&gt;ContextRefreshedEvent&lt;/tt&gt;, the &lt;tt&gt;Bus&lt;/tt&gt; and the &lt;tt&gt;DestinationRegistry&lt;/tt&gt; doesn&apos;t get reinitialized.&lt;/p&gt;

&lt;p&gt;I refresh the Spring context like this:&lt;br/&gt;
&lt;tt&gt;((ConfigurableApplicationContext)applicationContext).refresh();&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;I think the CXFServlet should implement &lt;tt&gt;ApplicationListener&amp;lt;ContextRefreshedEvent&amp;gt;&lt;/tt&gt; and register itself as an application listener on the Spring context and reinitialize itself in the &lt;tt&gt;onApplicationEvent&lt;/tt&gt; method.&lt;/p&gt;

&lt;p&gt;As an experiment I created a subclass to CXFServlet with the implementation of onApplicationEvent below (which seems to work). The real implementation could perhaps do a bit less work.&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;RefreshingCXFServlet.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Override
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void onApplicationEvent(ContextRefreshedEvent event) {
  destroy();
  setBus(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
  &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.init(m_sc);
  } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (ServletException e) {
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to reinitialize the CXFServlet&quot;&lt;/span&gt;, e);
  }
} 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </description>
                <environment></environment>
        <key id="12543635">CXF-4127</key>
            <summary>CXFServlet should be reinitialized on ContextRefreshedEvent</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="jensborgland">Jens Borgland</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Feb 2012 08:03:48 +0000</created>
                <updated>Mon, 23 Apr 2012 16:45:09 +0000</updated>
                            <resolved>Mon, 9 Apr 2012 20:32:47 +0000</resolved>
                                    <version>2.4.7</version>
                    <version>2.5.3</version>
                                    <fixVersion>2.5.3</fixVersion>
                    <fixVersion>2.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13213571" author="jensborgland" created="Wed, 22 Feb 2012 12:38:14 +0000"  >&lt;p&gt;Note that &lt;tt&gt;org.springframework.context.support.AbstractApplicationContext&lt;/tt&gt; recreates its &lt;tt&gt;ApplicationEventMulticaster&lt;/tt&gt; when the context is refreshed. The CXFServlet therefore needs to add itself to the set of statically specified application listeners instead.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;registering a listener&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;WebApplicationContext wac = WebApplicationContextUtils.getWebApplicationContext(getServletContext());
GenericApplicationListenerAdapter listener = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericApplicationListenerAdapter(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);

&lt;span class=&quot;code-comment&quot;&gt;// This won&apos;t work:
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//((ConfigurableWebApplicationContext) wac).addApplicationListener(listener);
&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;// This works:
&lt;/span&gt;((AbstractApplicationContext) wac).getApplicationListeners().add(listener);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12541951">CXF-4094</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228874</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b6of:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63194</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>