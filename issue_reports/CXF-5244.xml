<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat May 27 09:42:38 UTC 2023

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5244] It is not possible to update Content-Type inside JAX-RS 2.0 ContainerRequestFilter </title>
                <link>https://issues.apache.org/jira/browse/CXF-5244</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;As I understand, it wasn&apos;t possible to update headers inside JAX-RS 2.0 ContainerRequestFilter. &lt;br/&gt;
Is was fixed in this issue &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-4986&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-4986&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;But now update of Content-Type header inside of @PreMatching filter doesn&apos;t affect further processing - &lt;br/&gt;
suitable MessageBodyReader is selected using initial Content-Type but not new one.  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12666158">CXF-5244</key>
            <summary>It is not possible to update Content-Type inside JAX-RS 2.0 ContainerRequestFilter </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="dmitry.treskunov">Dmitry Treskunov</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Aug 2013 16:40:53 +0000</created>
                <updated>Wed, 9 Oct 2013 17:11:34 +0000</updated>
                            <resolved>Fri, 30 Aug 2013 12:36:48 +0000</resolved>
                                    <version>2.7.6</version>
                                    <fixVersion>2.7.7</fixVersion>
                    <fixVersion>3.0.0-milestone1</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13754648" author="sergey_beryozkin" created="Fri, 30 Aug 2013 12:36:49 +0000"  >&lt;p&gt;Also fixed an issue with customizing accept types in pre-matching filters&lt;/p&gt;</comment>
                            <comment id="13789924" author="jklap" created="Wed, 9 Oct 2013 01:34:55 +0000"  >&lt;p&gt;Previously you could add an interceptor before the JAXRSInInterceptor to check for and set either the Content-Type or Accept header via something like message.put(Message.ACCEPT_CONTENT_TYPE, ...)&lt;/p&gt;

&lt;p&gt;This change, as it now checks Message.PROTOCOL_HEADERS first and always sets any value it finds in the message would override the above.&lt;/p&gt;

&lt;p&gt;Is this expected behavior? Was setting the headers via message.put(Message.ACCEPT_CONTENT_TYPE, ...) the correct approach? Should JAXRSInInterceptor check for an existing header in the message before overriding?&lt;/p&gt;</comment>
                            <comment id="13790209" author="sergey_beryozkin" created="Wed, 9 Oct 2013 10:16:29 +0000"  >&lt;p&gt;Hi, the problem is that PreMatching ContainerRequestFilter operates on modifiable Map of headers, so if a given filter happens to set &quot;Content-Type&quot; on such a map, then the only way to ensure this value is picked up is to check the map first.&lt;/p&gt;

&lt;p&gt;As it happens CXF Message has Message.PROTOCOL_HEADERS and also a pair of Message.CONTENT_TYPE &amp;amp; Message.ACCEPT_CONTENT_TYPE properties, the latter is just there to make it simpler to access the most important headers. &lt;/p&gt;

&lt;p&gt;If you re-set only Message.CONTENT_TYPE but not sync it with Message.PROTOCOL_HEADERS then it is not obvious what to do now that ContainerRequestFilters have to be supported, what if the earlier interceptor does only update Message.PROTOCOL_HEADERS but not Message.CONTENT_TYPE ? &lt;/p&gt;

&lt;p&gt;What I mean is that JAXRSInInterceptor can try and sync Message.CONTENT_TYPE/ACCEPT_CONTENT_TYPE &amp;amp;  Message.PROTOCOL_HEADERS itself to make sure ClientRequestFilter sees the correct values, but it can not guarantee it will do the sync direction correctly.&lt;/p&gt;

&lt;p&gt;If you do the header updates before JAXRSInInterceptor is used, and not using JAX-RS 2.0 filters, then please also update Message.PROTOCOL_HEADERS, a bit more work, yes, but it will be the correct way to do it.&lt;/p&gt;

&lt;p&gt;Do you agree ?&lt;/p&gt;

&lt;p&gt;thanks&lt;/p&gt;


</comment>
                            <comment id="13790614" author="jklap" created="Wed, 9 Oct 2013 16:59:44 +0000"  >&lt;p&gt;Sounds correct-- and I&apos;m fine with your suggestion-- ie updating the PROTOCOL_HEADERS (and it isn&apos;t actually much more work at all). I am &lt;b&gt;not&lt;/b&gt; updating CONTENT_TYPE and ACCEPT_CONTENT_TYPE-- looks like that isn&apos;t needed. Can you confirm?&lt;/p&gt;

&lt;p&gt;As a side note, this interceptor was originally a Request Filter but we moved it to an interceptor-- can&apos;t remember why but we had a good reason &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13790625" author="sergey_beryozkin" created="Wed, 9 Oct 2013 17:11:34 +0000"  >&lt;p&gt;I guess it is not strictly required because JAXRSInInterceptor is checking the map and if it finds Content-Type or Accept then it also resets dedicated message properties.&lt;/p&gt;

&lt;p&gt;You probably moved because setting Content-Type in the handler was not having any effect on selecting the resource classes, or may be methods,&lt;/p&gt;

&lt;p&gt;try @PreMatching ContainerRequestFilter, it should work too and it will be portable &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>346097</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 34 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1nokf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>346398</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>