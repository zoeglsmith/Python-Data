<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat May 27 09:45:07 UTC 2023

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6078] AnnotationUtils.getAnnotatedMethod for abstract classes not inherit from interface</title>
                <link>https://issues.apache.org/jira/browse/CXF-6078</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I created the special junit test to demonstrate this bug.&lt;/p&gt;

&lt;p&gt;Suppose we have NameService with annotated methods: &apos;get&apos; and &apos;set&apos;.&lt;/p&gt;

&lt;p&gt;NameServiceImpl that implements NameService and only &apos;get&apos; method.&lt;/p&gt;

&lt;p&gt;AbstractNameServiceImpl that implements &apos;set&apos; method. &lt;/p&gt;

&lt;p&gt;NameServiceImpl extends AbstractNameServiceImpl.&lt;br/&gt;
AbstractNameServiceImpl does not implement NameService.&lt;/p&gt;

&lt;p&gt;For this case AnnotationUtils.getAnnotatedMethod returns wrong annotatedMethod for &apos;set&apos;. It is actually same method as requested one, but not the &apos;set&apos; method from the interface.&lt;/p&gt;

&lt;p&gt;m = public javax.ws.rs.core.Response NameServiceImpl.get(java.lang.String)&lt;br/&gt;
a = public abstract javax.ws.rs.core.Response NameService.get(java.lang.String)&lt;br/&gt;
m = public javax.ws.rs.core.Response AbstractNameServiceImpl.set(java.lang.String)&lt;br/&gt;
a = public javax.ws.rs.core.Response AbstractNameServiceImpl.set(java.lang.String)&lt;/p&gt;

&lt;p&gt;JDK1.7.0_51&lt;/p&gt;

&lt;p&gt;It happens because AnnotationUtils.getAnnotatedMethod has only single argument Method, that is the method &apos;set&apos; from super class AbstractNameServiceImpl. It does not have information about NameServiceImpl itself and does not check hierarchy of the NameServiceImpl as well. In fact, logically it checks superclass AbstractNameServiceImpl only, but really we are using NameServiceImpl as a service class. This is the bug.&lt;/p&gt;

&lt;p&gt;Solution:&lt;br/&gt;
AnnotationUtils.getAnnotatedMethod needs additional Class&amp;lt;?&amp;gt; serviceClass argument to check hierarchy of service class to find annotated method, that&apos;s because Method argument can be from any level of super class of the serviceClass and there is no guarantee that it implements base RESTful interface with annotated methods.&lt;/p&gt;

&lt;p&gt;It actually affects ResourceUtils.createClassResourceInfo&lt;br/&gt;
that calls AnnotationUtils.getAnnotatedMethod to detect annotated method in the loop&lt;/p&gt;

&lt;p&gt;    private static void evaluateResourceClass(ClassResourceInfo cri, boolean enableStatic) {&lt;br/&gt;
        MethodDispatcher md = new MethodDispatcher();&lt;br/&gt;
        for (Method m : cri.getServiceClass().getMethods()) {&lt;/p&gt;

&lt;p&gt;            Method annotatedMethod = AnnotationUtils.getAnnotatedMethod(m);&lt;/p&gt;

&lt;p&gt;It knows about ServiceClass, but does not use this information to walk in classes hierarchy.&lt;br/&gt;
For me, this bug leads to the situation that not all methods have mapping in the application.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12752150">CXF-6078</key>
            <summary>AnnotationUtils.getAnnotatedMethod for abstract classes not inherit from interface</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="alexshvid">Alexander Shvid</reporter>
                        <labels>
                    </labels>
                <created>Sat, 1 Nov 2014 03:37:38 +0000</created>
                <updated>Mon, 16 Feb 2015 16:09:04 +0000</updated>
                            <resolved>Wed, 5 Nov 2014 11:28:48 +0000</resolved>
                                    <version>2.7.13</version>
                                    <fixVersion>3.0.3</fixVersion>
                    <fixVersion>2.7.14</fixVersion>
                    <fixVersion>3.1</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14192946" author="alexshvid" created="Sat, 1 Nov 2014 03:40:30 +0000"  >&lt;p&gt;JUnit test&lt;/p&gt;</comment>
                            <comment id="14194560" author="sergey_beryozkin" created="Mon, 3 Nov 2014 14:14:43 +0000"  >&lt;p&gt;Hi, this issue is probably invalid...&lt;br/&gt;
JAX-RS annotation inheritance is quite specific, it does not support the overriding of annotations and abstract classes are preferred to interfaces in the search order, see&lt;br/&gt;
&lt;a href=&quot;https://jsr311.java.net/nonav/releases/1.1/spec/spec.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jsr311.java.net/nonav/releases/1.1/spec/spec.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14194789" author="alexshvid" created="Mon, 3 Nov 2014 17:51:46 +0000"  >&lt;p&gt;From &lt;a href=&quot;https://jsr311.java.net/nonav/releases/1.1/spec/spec.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jsr311.java.net/nonav/releases/1.1/spec/spec.html&lt;/a&gt;&lt;br/&gt;
It is not this case:&lt;br/&gt;
&quot;Annotations on a super-class take precedence over those on an implemented interface. If a subclass or implementation method has any JAX-RS annotations then all of the annotations on the super class or interface method are ignored.&quot;&lt;/p&gt;

&lt;p&gt;As we see, AbstractNameServiceImpl does not have annotations.&lt;/p&gt;</comment>
                            <comment id="14195187" author="sergey_beryozkin" created="Mon, 3 Nov 2014 21:59:58 +0000"  >&lt;p&gt;well, NameServiceImpl implements NameService.set method by the virtue of extending AbstractNameServiceImpl. &lt;br/&gt;
So, yes, AbstractNameServiceImpl.set method is the one that would serve as a resource method. What exactly is not right with that ?&lt;/p&gt;
</comment>
                            <comment id="14195213" author="alexshvid" created="Mon, 3 Nov 2014 22:12:56 +0000"  >&lt;p&gt;If a subclass or implementation method has any JAX-RS annotations then all of the annotations on the super class or interface method are ignored &lt;/p&gt;

&lt;p&gt;AbstractNameServiceImpl does not have annotations, it have to be ignored and used NameService interface for method annotations. This is the bug.&lt;/p&gt;</comment>
                            <comment id="14195970" author="sergey_beryozkin" created="Tue, 4 Nov 2014 10:02:01 +0000"  >&lt;p&gt;May be I&apos;m missing something. What is the actual issue you are seeing in your JAX-RS application ? &lt;/p&gt;</comment>
                            <comment id="14196363" author="alexshvid" created="Tue, 4 Nov 2014 17:07:01 +0000"  >&lt;p&gt;I already wrote&lt;/p&gt;

&lt;p&gt;&quot;For me, this bug leads to the situation that not all methods are having mapping in the application.&quot;&lt;br/&gt;
That means that AnnotationUtils.getAnnotatedMethod skips some method declarations that are fully legal by JAX-RS specification. In this current test &apos;set&apos; method is fully legal and it was skipped.&lt;/p&gt;

</comment>
                            <comment id="14198254" author="sergey_beryozkin" created="Wed, 5 Nov 2014 11:28:27 +0000"  >&lt;p&gt;Yes - you are right. I&apos;ve added your test resources but to the systests/jaxrs where I have a system test checking the end to end invocation...&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12678658" name="AbstractNameServiceImpl.java" size="171" author="alexshvid" created="Sat, 1 Nov 2014 03:40:30 +0000"/>
                            <attachment id="12678659" name="AnnotationUtilsTest.java" size="452" author="alexshvid" created="Sat, 1 Nov 2014 03:40:30 +0000"/>
                            <attachment id="12678660" name="NameService.java" size="503" author="alexshvid" created="Sat, 1 Nov 2014 03:40:30 +0000"/>
                            <attachment id="12678661" name="NameServiceImpl.java" size="220" author="alexshvid" created="Sat, 1 Nov 2014 03:40:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 30 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21ujj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>