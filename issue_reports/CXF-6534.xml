<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat May 27 09:48:36 UTC 2023

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6534] Kerberos delegation not possible if Authorization given</title>
                <link>https://issues.apache.org/jira/browse/CXF-6534</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Issue discovered while migrating from version 3.0.2 to 3.1.2.&lt;/p&gt;

&lt;p&gt;In documentation it&apos;s say that to enable kerberos you have to give the informations policy for Authorization and AuthorizationType:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&amp;lt;conduit name=&lt;span class=&quot;code-quote&quot;&gt;&quot;{http://example.com/}HelloWorldServicePort.http-conduit&quot;&lt;/span&gt;
  xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://cxf.apache.org/transports/http/configuration&quot;&lt;/span&gt;&amp;gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;authorization&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AuthorizationType&amp;gt;&lt;/span&gt;Negotiate&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/AuthorizationType&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Authorization&amp;gt;&lt;/span&gt;CXFClient&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Authorization&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/authorization&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/conduit&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And for delegation it&apos;s not necessary to give the Authorization field.&lt;br/&gt;
But If you give a policy with both of them, It will never try to do delegation, resulting in my application not working anymore (browser -&amp;gt; unix(wildfly) -&amp;gt; windows 2012 by kerberos delegation).&lt;/p&gt;

&lt;p&gt;After a look to the source code, it seems the problem is due to a change in version 3.0.4 for the file AbstractSpnegoAuthSupplier.java:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] getToken(AuthorizationPolicy authPolicy, 
                            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; spn, 
                            Oid oid,
                            Message message) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; GSSException, 
        LoginException {
        
        Subject subject = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (authPolicy != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; contextName = authPolicy.getAuthorization();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (contextName == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                contextName = &quot;&quot;;
            }
        
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!(StringUtils.isEmpty(authPolicy.getUserName())
                &amp;amp;&amp;amp; StringUtils.isEmpty(contextName) &amp;amp;&amp;amp; loginConfig == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)) {
                CallbackHandler callbackHandler = getUsernamePasswordHandler(
                    authPolicy.getUserName(), authPolicy.getPassword());
                LoginContext lc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LoginContext(contextName, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, callbackHandler, loginConfig);
                lc.login();
                subject = lc.getSubject();
            }
        }
                                                                 
        GSSManager manager = GSSManager.getInstance();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the contextName is not null, it will always try to use getUsernamePasswordHandler resulting in a loginException.&lt;/p&gt;

&lt;p&gt;Workaround : not specifying an authorization&lt;/p&gt;

&lt;p&gt;Possible fix :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (authPolicy != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !isCredDelegationRequired(message)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Do not hesitate to tell me if there is another way to do it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12855583">CXF-6534</key>
            <summary>Kerberos delegation not possible if Authorization given</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="Bonky42">Bernard Chesnoy</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Aug 2015 15:33:04 +0000</created>
                <updated>Fri, 14 Oct 2016 14:12:15 +0000</updated>
                            <resolved>Fri, 14 Aug 2015 14:09:40 +0000</resolved>
                                    <version>3.0.4</version>
                    <version>3.1</version>
                    <version>3.0.5</version>
                    <version>3.1.1</version>
                    <version>3.0.6</version>
                    <version>3.1.2</version>
                    <version>3.1.3</version>
                                    <fixVersion>3.1.3</fixVersion>
                    <fixVersion>3.0.7</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14697021" author="coheigea" created="Fri, 14 Aug 2015 13:51:34 +0000"  >
&lt;p&gt;Fix merged. Could you verify that it is working for you?&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2itvz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>