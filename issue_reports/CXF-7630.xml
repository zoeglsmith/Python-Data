<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat May 27 09:43:19 UTC 2023

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7630] NameBindings are ignored for (at least) ContextResponseFilters</title>
                <link>https://issues.apache.org/jira/browse/CXF-7630</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;If we create a &lt;em&gt;NameBinding&lt;/em&gt; annotation:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@NameBinding
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.TYPE, ElementType.METHOD})
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; @&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Filtered {
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and qualify a &lt;em&gt;ContainerResponseFilter&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Filtered
@Provider
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestNameBoundFilter &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ContainerResponseFilter {

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void filter(
            ContainerRequestContext requestContext,
            ContainerResponseContext responseContext)
        &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {

        MultivaluedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; headers = responseContext.getHeaders();

        headers.putSingle(&lt;span class=&quot;code-quote&quot;&gt;&quot;NameBoundFiltered&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;);
    }

}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and some methods in a &lt;em&gt;Resource&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;NameBoundResource {

    @GET
    @Filtered
    @Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/filtered&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; filtered() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;filtered&quot;&lt;/span&gt;;
    }

    @GET
    @Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/unfiltered&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; unfiltered() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;unfiltered&quot;&lt;/span&gt;;
    }

}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;only responses for requests made to &lt;em&gt;&quot;/filtered&quot;&lt;/em&gt; path should carry the &lt;em&gt;&quot;NameBoundHeader&quot;&lt;/em&gt; header. However both responses, to &lt;em&gt;&quot;/filtered&quot;&lt;/em&gt; and &lt;em&gt;&quot;/unfiltered&quot;&lt;/em&gt; carry the header.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13135492">CXF-7630</key>
            <summary>NameBindings are ignored for (at least) ContextResponseFilters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="csierra">Carlos Sierra Andr&#233;s</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Feb 2018 17:09:38 +0000</created>
                <updated>Wed, 7 Feb 2018 14:52:07 +0000</updated>
                            <resolved>Fri, 2 Feb 2018 13:10:47 +0000</resolved>
                                    <version>3.2.2</version>
                                    <fixVersion>3.2.2</fixVersion>
                    <fixVersion>3.1.15</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16349001" author="sergey_beryozkin" created="Thu, 1 Feb 2018 17:51:56 +0000"  >&lt;p&gt;Seems to be an invalid issue; in systests/jaxrs BookServer20 has a PostMatchContainerResponseFilter3, with the name bindings (2 of them). If you comment them out then JAXRS20ClientServerBookTest fails. May be the annotation visibility issue ?&lt;/p&gt;</comment>
                            <comment id="16349010" author="csierra" created="Thu, 1 Feb 2018 18:00:11 +0000"  >&lt;p&gt;I was actually looking at those and I thought that maybe they did not check for &lt;em&gt;overbinding&lt;/em&gt;. What do you mean by the &quot;annotation visibility issue&quot;? that may be it.&lt;/p&gt;</comment>
                            <comment id="16349050" author="csierra" created="Thu, 1 Feb 2018 18:26:31 +0000"  >&lt;p&gt;I am checking the OperationMethodInfos and they correctly declare one of the methods being bound and the other not bound. Does that help?&lt;/p&gt;</comment>
                            <comment id="16349194" author="sergey_beryozkin" created="Thu, 1 Feb 2018 20:20:15 +0000"  >&lt;p&gt;Not really - I see a CXF test which is working&lt;/p&gt;</comment>
                            <comment id="16349992" author="githubbot" created="Fri, 2 Feb 2018 08:49:58 +0000"  >&lt;p&gt;csierra opened a new pull request #376: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7630&quot; title=&quot;NameBindings are ignored for (at least) ContextResponseFilters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7630&quot;&gt;&lt;del&gt;CXF-7630&lt;/del&gt;&lt;/a&gt; Do not preset namebindings when installing through a Feature&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/376&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/376&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   This makes `@NameBinding` work also when installing filters using a `Feature`&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16349995" author="csierra" created="Fri, 2 Feb 2018 08:52:35 +0000"  >&lt;p&gt;Hi again,&lt;/p&gt;

&lt;p&gt;I think I have made progress and &lt;em&gt;@NameBinding&lt;/em&gt; seems to not work when the filter is installed using a JAX-RS &lt;em&gt;Feature&lt;/em&gt;. I am sorry I did not mention I am using a Feature to register the filter.&lt;/p&gt;

&lt;p&gt;I have sent a pull with a possible (possibly naive) fix to the problem.&lt;/p&gt;

&lt;p&gt;Bests.&lt;/p&gt;

&lt;p&gt;Carlos.&lt;/p&gt;</comment>
                            <comment id="16350194" author="sergey_beryozkin" created="Fri, 2 Feb 2018 11:40:48 +0000"  >&lt;p&gt;Hi Carlos&lt;br/&gt;
Thanks, I&apos;ll merge and then may be tweak a bit&lt;/p&gt;</comment>
                            <comment id="16350195" author="githubbot" created="Fri, 2 Feb 2018 11:41:53 +0000"  >&lt;p&gt;asfgit closed pull request #376: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7630&quot; title=&quot;NameBindings are ignored for (at least) ContextResponseFilters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7630&quot;&gt;&lt;del&gt;CXF-7630&lt;/del&gt;&lt;/a&gt; Do not preset namebindings when installing through a Feature&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/376&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/376&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/FilterProviderInfo.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/FilterProviderInfo.java&lt;br/&gt;
index 0f04b5e94c8..1c92de28a56 100644&lt;br/&gt;
&amp;#8212; a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/FilterProviderInfo.java&lt;br/&gt;
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/FilterProviderInfo.java&lt;br/&gt;
@@ -49,7 +49,7 @@ public FilterProviderInfo(Class&amp;lt;?&amp;gt; resourceClass,&lt;br/&gt;
                               boolean dynamic,&lt;br/&gt;
                               Map&amp;lt;Class&amp;lt;?&amp;gt;, Integer&amp;gt; supportedContracts) &lt;/p&gt;
{
         super(resourceClass, serviceClass, provider, bus, true);
-        this.nameBinding = Collections.singleton(nameBinding);
+        this.nameBinding = nameBinding == null ? null : Collections.singleton(nameBinding);
         this.supportedContracts = supportedContracts;
         this.dynamic = dynamic;
     }
&lt;p&gt;diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
index bf4ddf1b72d..54eba425543 100644&lt;br/&gt;
&amp;#8212; a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
@@ -219,6 +219,8 @@ protected void setProviders(boolean custom, boolean busGlobal, Object... provide&lt;br/&gt;
                                                                         providerCls,&lt;br/&gt;
                                                                         featureProvider,&lt;br/&gt;
                                                                         getBus(),&lt;br/&gt;
+                                                                        null,&lt;br/&gt;
+                                                                        false,&lt;br/&gt;
                                                                         contracts));&lt;br/&gt;
                     } else {&lt;br/&gt;
                         allProviders.add(featureProvider);&lt;br/&gt;
diff --git a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/BookServer20.java b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/BookServer20.java&lt;br/&gt;
index d1b514889d2..02b61a64912 100644&lt;br/&gt;
&amp;#8212; a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/BookServer20.java&lt;br/&gt;
+++ b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/BookServer20.java&lt;br/&gt;
@@ -90,7 +90,11 @@ protected void run() {&lt;br/&gt;
         providers.add(new PreMatchContainerRequestFilter2());&lt;br/&gt;
         providers.add(new PreMatchContainerRequestFilter());&lt;br/&gt;
         providers.add(new PostMatchContainerResponseFilter());&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;providers.add(new PostMatchContainerResponseFilter3());&lt;br/&gt;
+        providers.add((Feature) context -&amp;gt; 
{
+            context.register(new PostMatchContainerResponseFilter3());
+
+            return true;
+        }
&lt;p&gt;);&lt;br/&gt;
         providers.add(new PostMatchContainerResponseFilter2());&lt;br/&gt;
         providers.add(new CustomReaderBoundInterceptor());&lt;br/&gt;
         providers.add(new CustomReaderInterceptor());&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16350282" author="sergey_beryozkin" created="Fri, 2 Feb 2018 13:01:36 +0000"  >&lt;p&gt;I just did a minor follow up update to make sure the bindings are always not null, to avoid some possible NPE further down the line (in one branch, if it is a dynamic, getBindings are used directly, etc), hope you agree&lt;/p&gt;</comment>
                            <comment id="16350294" author="sergey_beryozkin" created="Fri, 2 Feb 2018 13:10:47 +0000"  >&lt;p&gt;Thanks for the patch&lt;/p&gt;</comment>
                            <comment id="16350297" author="csierra" created="Fri, 2 Feb 2018 13:15:02 +0000"  >&lt;p&gt;Sure...&lt;/p&gt;

&lt;p&gt;thanks to you for all your support!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3pnz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>